<!DOCTYPE html>
<html>
<head>
    <title>{{ post.title }}</title>
    <link rel="stylesheet" href="/static/blog/style.css">
</head>
<body>
    <header><h1>Gloria's Django Blog</h1></header>
    <main>
        <article>
            <h2>{{ post.title }}</h2>
            <p><small>By {{ post.author.username }} on {{ post.published_date }}</small></p>
            <div>{{ post.content|linebreaks }}</div>
            <p>
                <strong>Tags:</strong>
                {% for tag in post.tags.all %}
                <a href="{% url 'posts_by_tag' tag.slug %}">{{ tag.name }}</a>{% if not forloop.last %}, {% endif %}
                {% endfor %}
            </p>
        </article>

        <hr>
        <h3>Comments</h3>
        {% for comment in post.comments.all %}
            <div style="margin-bottom: 20px; border-left: 3px solid #ccc; padding-left: 10px;">
                <p>{{ comment.content }}</p>
                <p><small>By {{ comment.author.username }} on {{ comment.created_at }}</small></p>
                {% if user == comment.author %}
                    <p>
                        <a href="{% url 'edit_comment' comment.pk %}">Edit</a> |
                        <a href="{% url 'delete_comment' comment.pk %}">Delete</a>
                    </p>
                {% endif %}
            </div>
        {% empty %}
            <p>No comments yet.</p>
        {% endfor %}

        {% if user.is_authenticated %}
            <h4>Add a Comment</h4>
            <form method="post" action="{% url 'add_comment' post.pk %}">
                {% csrf_token %}
                {{ comment_form.as_p }}
                <button type="submit">Post Comment</button>
            </form>
        {% else %}
            <p><a href="{% url 'login' %}">Login</a> to leave a comment.</p>
        {% endif %}

        <p><a href="{% url 'post_list' %}">‚Üê Back to all posts</a></p>
    </main>
</body>
</html>